<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>General interconnect - Project Combine</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">Project Combine</h1>

                    <div class="right-buttons">

                    </div>
                </div>


                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="general-interconnect"><a class="header" href="#general-interconnect">General interconnect</a></h1>
<p>The Spartan 3 general interconnect is essentially a scaled-down version of <a href="../../virtex2/interconnect/README.html">Virtex 2 interconnect</a>.</p>
<p>The general interconnect of Virtex 2 is made of several kinds of similar, but not identical interconnect tiles. The tile types include:</p>
<ul>
<li><code>INT.CLB</code>, the interconnect tile associated with <a href="../clb.html">configurable logic blocks</a> and corner tiles</li>
<li><code>INT.BRAM.*</code>, the interconnect tile associated with <a href="../bram.html">block RAMs</a></li>
<li><code>INT.IOI.*</code>, the interconnect tile associated with <a href="../io/README.html">I/O tiles</a></li>
<li><code>INT.DCM.*</code>, the interconnect tiles associated with <a href="../dcm-s3.html">digital clock managers</a></li>
</ul>
<p>The various tile types have the same backbone, but differ in the types of input multiplexers they have, mostly clock multiplexers.</p>
<h2 id="backbone"><a class="header" href="#backbone">Backbone</a></h2>
<p>The core of the interconnect is made of the following wires, each of which is instantiated once per interconnect tile and is driven by a buffered multiplexer:</p>
<ul>
<li>
<p><code>OMUX0</code> through <code>OMUX15</code>, per-tile output multiplexers. The inputs to those include various primitive outputs in the tile. They serve as single-hop interconnect wires — each <code>OMUX</code> wire is also visible in one or two of the (immediately or diagonally) adjacent interconnect tiles:</p>
<div class="table-wrapper"><table><thead><tr><th>Wire</th><th>Direction</th><th>Wire in tile #1</th><th>Wire in tile #2</th></tr></thead><tbody>
<tr><td><code>OMUX0</code></td><td><code>S</code></td><td><code>OMUX0.S</code></td><td></td></tr>
<tr><td><code>OMUX1</code></td><td><code>W</code>, then <code>S</code></td><td><code>OMUX1.W</code></td><td><code>OMUX1.WS</code></td></tr>
<tr><td><code>OMUX2</code></td><td><code>E</code> and <code>S</code></td><td><code>OMUX2.E</code></td><td><code>OMUX2.S</code></td></tr>
<tr><td><code>OMUX3</code></td><td><code>S</code>, then <code>E</code></td><td><code>OMUX3.S</code></td><td><code>OMUX3.SE</code></td></tr>
<tr><td><code>OMUX4</code></td><td><code>S</code></td><td><code>OMUX4.S</code></td><td></td></tr>
<tr><td><code>OMUX5</code></td><td><code>S</code>, then <code>W</code></td><td><code>OMUX5.S</code></td><td><code>OMUX5.SW</code></td></tr>
<tr><td><code>OMUX6</code></td><td><code>W</code></td><td><code>OMUX6.W</code></td><td></td></tr>
<tr><td><code>OMUX7</code></td><td><code>E</code>, then <code>S</code></td><td><code>OMUX7.E</code></td><td><code>OMUX7.ES</code></td></tr>
<tr><td><code>OMUX8</code></td><td><code>E</code>, then <code>N</code></td><td><code>OMUX8.E</code></td><td><code>OMUX8.EN</code></td></tr>
<tr><td><code>OMUX9</code></td><td><code>W</code> and <code>N</code></td><td><code>OMUX9.W</code></td><td><code>OMUX9.N</code></td></tr>
<tr><td><code>OMUX10</code></td><td><code>N</code>, then <code>W</code></td><td><code>OMUX10.N</code></td><td><code>OMUX10.NW</code></td></tr>
<tr><td><code>OMUX11</code></td><td><code>N</code></td><td><code>OMUX11.N</code></td><td></td></tr>
<tr><td><code>OMUX12</code></td><td><code>N</code>, then <code>E</code></td><td><code>OMUX12.N</code></td><td><code>OMUX12.NE</code></td></tr>
<tr><td><code>OMUX13</code></td><td><code>E</code></td><td><code>OMUX13.E</code></td><td></td></tr>
<tr><td><code>OMUX14</code></td><td><code>W</code>, then <code>N</code></td><td><code>OMUX14.W</code></td><td><code>OMUX12.WN</code></td></tr>
<tr><td><code>OMUX15</code></td><td><code>N</code></td><td><code>OMUX15.N</code></td><td></td></tr>
</tbody></table>
</div><div class="warning">this table is very similar to, but subtly different from the corresponding Virtex 2 table (the differences are in `OMUX9` and `OMUX13`).</div>
</li>
<li>
<p>Double lines going in the cardinal directions, 8 per direction, called <code>DBL.[EWSN][0-7]</code>. Each of them has three segments, called <code>DBL.[EWSN][0-7].[0-2]</code>, where <code>.0</code> is located in the source tile and is driven, <code>.1</code> is in the next tile in the relevant direction, and <code>.2</code> is in the next tile after that. Some of the lines additionally have a fourth segment:</p>
<ul>
<li><code>DBL.W[67].3</code> is to the north of <code>DBL.W[67].2</code></li>
<li><code>DBL.E[01].3</code> is to the south of <code>DBL.E[01].2</code></li>
<li><code>DBL.S[01].3</code> is to the south of <code>DBL.S[01].2</code></li>
<li><code>DBL.N[67].3</code> is to the north of <code>DBL.N[67].2</code></li>
</ul>
<p>Only the <code>.0</code> segment is driven. The inputs to the multiplexer include:</p>
<ul>
<li><code>OMUX</code> wires</li>
<li><code>.1</code>, <code>.2</code> and <code>.3</code> segments of other <code>DBL</code> wires</li>
<li><code>.3</code>, <code>.6</code> and <code>.7</code> segments of <code>HEX</code> wires</li>
<li><code>OUT.FAN</code> wires</li>
</ul>
</li>
<li>
<p>Hex lines going in the cardinal directions, 8 per direction, called <code>HEX.[EWSN][0-7]</code>. They are analogous to double lines, except they have 7 (or sometimes 8) segments, thus spanning a distance of 6 tiles. The lines with 8th segment include:</p>
<ul>
<li><code>HEX.W[67].7</code> is to the north of <code>HEX.W[67].6</code></li>
<li><code>HEX.E[01].7</code> is to the south of <code>HEX.E[01].6</code></li>
<li><code>HEX.S[01].7</code> is to the south of <code>HEX.S[01].6</code></li>
<li><code>HEX.N[67].7</code> is to the north of <code>HEX.N[67].6</code></li>
</ul>
<p>Only the <code>.0</code> segment is driven. The inputs to the multiplexer include:</p>
<ul>
<li><code>OMUX</code> wires</li>
<li><code>.3</code>, <code>.6</code> and <code>.7</code> segments of other <code>HEX</code> wires</li>
<li><code>.0</code>, <code>.6</code>, <code>.12</code>, <code>.18</code> segments of <code>LV</code> wires (for vertical lines)</li>
<li><code>.0</code>, <code>.6</code>, <code>.12</code>, <code>.18</code> segments of <code>LH</code> wires (for horizontal lines)</li>
<li><code>OUT.FAN</code> wires</li>
</ul>
<p>Some hex lines are associated with various kind of input multiplexers, such that a single hex line can drive all input multiplexers of given type through its <code>.0</code> to <code>.5</code> segments:</p>
<ul>
<li><code>HEX.[SN]0</code> is associated with <code>IMUX.SR*</code></li>
<li><code>HEX.[SN]4</code> is associated with <code>IMUX.CLK*</code> and <code>IMUX.IOCLK*</code></li>
<li><code>HEX.[SN]7</code> is associated with <code>IMUX.CE*</code></li>
</ul>
</li>
</ul>
<p>For large-fanout nets or nets that need to span long distances, the interconnect also has long lines that span the whole width or height of the device. There are 24 vertical long lines, <code>LV</code>, per an interconnect column, and 24 horizontal long lines, <code>LH</code>, per an interconnect row. They are visible as <code>LV.{0-23}</code> and <code>LH.{0-23}</code> segments in each interconnect tile, in a rotating way: <code>LH.0</code> in a given tile is visible as <code>LH.1</code> or <code>LH.23</code> in the horizontally adjacent tiles.
Only <code>.0</code>, <code>.6</code>, <code>.12</code>, <code>.18</code> segments of long wires are actually accessible to a tile — the rest are just passing through.</p>
<p>Each interconnect tile can optionally drive the long line segments accessible to it via buffered multiplexers. The inputs to <code>LH</code> driver multiplexers include:</p>
<ul>
<li><code>OMUX</code> wires</li>
<li><code>.1</code> segments of <code>DBL</code> wires</li>
</ul>
<p>The inputs to <code>LV</code> driver multiplexers include:</p>
<ul>
<li><code>OMUX</code> wires</li>
<li><code>.1</code> segments of <code>DBL</code> wires</li>
<li>various segments of <code>HEX.E0</code> and <code>HEX.W6</code> wires</li>
</ul>
<p>The every-6-tiles nature of long wires combined with existence of hex wires allows for easy distribution of signals everywhere on the FPGA.</p>
<h2 id="input-multiplexers"><a class="header" href="#input-multiplexers">Input multiplexers</a></h2>
<p>Every interconnect tile also contains input multiplexers, which drive the associated primitive inputs. The exact set of available input multiplexers depends on the type of interconnect tile.</p>
<p>The baseline set of input muxes is present in the <code>INT.CLB</code> tile:</p>
<ul>
<li>
<p><code>IMUX.CLK[0-3]</code>: four clock inputs. In CLBs, they correspond to the four <code>SLICE</code>\ s. They are multiplexed from:</p>
<ul>
<li><code>PULLUP</code>, a dummy always-1 wire</li>
<li><code>GCLK0</code> through <code>GCLK7</code>, the <a href="../clock/README.html">clock interconnect</a> global lines</li>
<li>various segments of <code>DBL</code> lines</li>
<li>any segment of <code>HEX.S4</code> and <code>HEX.N4</code> lines</li>
</ul>
<p>The <code>IMUX.CLK</code> multiplexers have a programmable inverter.</p>
</li>
<li>
<p><code>IMUX.SR[0-3]</code>: four set/reset inputs. In CLBs, they correspond to the four <code>SLICE</code>\ s. They are multiplexed from:</p>
<ul>
<li><code>PULLUP</code>, a dummy always-1 wire</li>
<li>various segments of <code>DBL</code> lines</li>
<li>any segment of <code>HEX.S0</code> and <code>HEX.N0</code> lines</li>
</ul>
<p>The <code>IMUX.SR</code> multiplexers have a programmable inverter.</p>
</li>
<li>
<p><code>IMUX.CE[0-3]</code>: four clock enable inputs. In CLBs, they correspond to the four <code>SLICE</code>\ s. They are multiplexed from:</p>
<ul>
<li><code>PULLUP</code>, a dummy always-1 wire</li>
<li>various segments of <code>DBL</code> lines</li>
<li>any segment of <code>HEX.S7</code> and <code>HEX.N7</code> lines</li>
</ul>
<p>The <code>IMUX.CE</code> multiplexers have a programmable inverter.</p>
</li>
<li>
<p><code>IMUX.FAN.B[XY][0-3]</code>: 8 fanout inputs, corresponding to <code>BX</code> and <code>BY</code> in CLBs. They are special in that they can be used both as primitive inputs and as extra routing resources to reach other primitive inputs (specifically, <code>IMUX.DATA*</code>). They are multiplexed from:</p>
<ul>
<li><code>PULLUP</code>, a dummy always-1 wire</li>
<li><code>OMUX</code> wires</li>
<li>various segments of <code>DBL</code> lines</li>
<li>other <code>IMUX.FAN.*</code> wires</li>
</ul>
</li>
<li>
<p><code>IMUX.DATA[0-31]</code>: 32 general data inputs, corresponding to LUT inputs in CLBs. They are multiplexed from the same sources as <code>IMUX.FAN.*</code> lines.</p>
</li>
</ul>
<p>The input multiplexers in <code>INT.BRAM</code> tiles are essentially subsets of <code>INT.CLB</code>. The <code>INT.BRAM.S3A.03</code> tiles are specifically missing <code>IMUX.CLK</code> and <code>IMUX.CE</code> because their bitstream tile space is repurposed for hard multiplier input selection.</p>
<p>The <code>INT.DCM.*</code> tiles are a variant of <code>INT.CLB</code> with one difference: the <code>IMUX.CLK*</code> inputs can be additionally multiplexed from <code>DCM.CLKPAD[0-3]</code>, which are direct inputs from clock I/O pads (see <a href="../clock/README.html">clock interconnect</a>).</p>
<p>The <code>INT.IOI*</code> tiles are a variant of <code>INT.CLB</code> with the following differences:</p>
<ul>
<li>
<p><code>IMUX.CLK*</code> are not present</p>
</li>
<li>
<p>the <code>IMUX.IOCLK[0-7]</code> inputs are added, which are multiplexed from:</p>
<ul>
<li><code>PULLUP</code>, a dummy always-1 wire</li>
<li><code>GCLK0</code> through <code>GCLK7</code>, the <a href="../clock/README.html">clock interconnect</a> global lines</li>
<li>various segments of <code>DBL</code> lines</li>
<li>any segment of <code>HEX.S4</code> and <code>HEX.N4</code> lines</li>
</ul>
<p>The <code>IMUX.IOCLK*</code> lines are not invertible on interconnect level, but they have inverters in the <code>IOI</code> primitives.</p>
</li>
</ul>
<h2 id="primitive-outputs"><a class="header" href="#primitive-outputs">Primitive outputs</a></h2>
<p>Primitive outputs are wires that go from the various primitives into the general interconnect. The set of available primitive outputs depends on the type of the interconnect tile. The <code>OUT.FAN*</code> outputs can be used as inputs to many interconnect multiplexers, while other outputs can only be routed via <code>OMUX</code> multiplexers.</p>
<p>The <code>INT.CLB</code>, <code>INT.DCM.*</code>, and <code>INT.IOI.*</code> tiles have the following primitive outputs:</p>
<ul>
<li><code>OUT.FAN[0-7]</code>: the main combinational LUT outputs (<code>X</code> and <code>Y</code>); they have access to many more routing resources than other outputs</li>
<li><code>OUT.SEC[0-15]</code>: the remaining SLICE outputs (<code>XQ</code>, <code>YQ</code>, <code>XB</code>, <code>YB</code>)</li>
</ul>
<p>Every <code>OMUX</code> multiplexer can mux from all <code>OUT.FAN</code> and <code>OUT.SEC</code> wires.</p>
<p>The <code>INT.BRAM.*</code> tiles have the following primitive outputs:</p>
<ul>
<li><code>OUT.FAN[0-7]</code>: as above</li>
<li><code>OUT.SEC[4-15]</code>: as above</li>
<li><code>OUT.HALF[0-3].[0-1]</code>: they take the place of <code>OUT.SEC[0-3]</code>; <code>.0</code> outputs are routed only to <code>OMUX[0-7]</code> while <code>.1</code> outputs are routed only to <code>OMUX[8-15]</code>, creating a possible bottleneck</li>
</ul>
<h2 id="terminators"><a class="header" href="#terminators">Terminators</a></h2>
<p>The edges of the device contain special <code>TERM.[EWSN]</code> tiles that handle interconnect lines going out-of-bounds:</p>
<ul>
<li><code>DBL</code> lines get reflected — eg. northbound lines "bounce off" the top edge and become southbound lines</li>
<li><code>HEX</code> lines are likewise reflected</li>
<li>long lines begin and end at <code>TERM</code> tiles</li>
<li><code>OMUX</code> lines going out of bounds are unconnected</li>
</ul>
<p>The Spartan 3E devices contain special <code>TERM.BRAM.[SN]</code> tiles that handle vertical interconnect lines hitting the bottom and top edge of the BRAM column. They work like <code>TERM.[EWSN]</code>, but they pass long lines through to the other end of the BRAM column.</p>
<p>The top and bottom of Spartan 3A BRAM columns don't have a terminator — the out-of-bounds interconnect lines just go nowhere and aren't usable.</p>
<h2 id="long-line-splitters"><a class="header" href="#long-line-splitters">Long line splitters</a></h2>
<p>On larger Spartan 3E and Spartan 3A devices, the horizontal clock spine contains <code>LLV</code> tiles, which contain programmable buffers that can optionally join the top and bottom segments of <code>LV</code> lines (they can buffer each line top-to-bottom, bottom-to-top, or the two segments can be disconnected and used for different signals). Likewise, the primary vertical clock spine contains <code>LLH</code> tiles, which can optionally join the left and right segments of <code>LH</code> lines.</p>
<p>The area of horizontal clock spine located within the inside of BRAM column doesn't contain <code>LLV</code> tiles. This is moot anyway, as the columns don't have enough interconnect tiles for the long lines to actually be useful (each long line only has at most one tap, making them useless).</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../spartan3/geometry.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../spartan3/interconnect/tiles-int.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../spartan3/geometry.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../spartan3/interconnect/tiles-int.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>



        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
